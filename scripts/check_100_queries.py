from random import sample
from etl.idealista.api import load_token, run_queries
import json

location_ids = [
  "0-EU-ES-28-07-001-079-02-006",
  "0-EU-ES-28-07-001-079-02-001",
  "0-EU-ES-28-07-001-079-02-002",
  "0-EU-ES-28-07-001-079-02-005",
  "0-EU-ES-28-07-001-079-02-003",
  "0-EU-ES-28-07-001-079-02-004",
  "0-EU-ES-28-07-001-079-21-001",
  "0-EU-ES-28-07-001-079-21-004",
  "0-EU-ES-28-07-001-079-21-003",
  "0-EU-ES-28-07-001-079-21-005",
  "0-EU-ES-28-07-001-079-21-002",
  "0-EU-ES-28-07-001-079-04-004",
  "0-EU-ES-28-07-001-079-04-002",
  "0-EU-ES-28-07-001-079-04-005",
  "0-EU-ES-28-07-001-079-04-003",
  "0-EU-ES-28-07-001-079-04-001",
  "0-EU-ES-28-07-001-079-04-006",
  "0-EU-ES-28-07-001-079-11-005",
  "0-EU-ES-28-07-001-079-11-003",
  "0-EU-ES-28-07-001-079-11-004",
  "0-EU-ES-28-07-001-079-11-006",
  "0-EU-ES-28-07-001-079-11-002",
  "0-EU-ES-28-07-001-079-11-007",
  "0-EU-ES-28-07-001-079-11-001",
  "0-EU-ES-28-07-001-079-11-008",
  "0-EU-ES-28-07-001-079-01-002",
  "0-EU-ES-28-07-001-079-01-004",
  "0-EU-ES-28-07-001-079-01-001",
  "0-EU-ES-28-07-001-079-05-001",
  "0-EU-ES-28-07-001-079-05-004",
  "0-EU-ES-28-07-001-079-05-002",
  "0-EU-ES-28-07-001-079-05-006",
  "0-EU-ES-28-07-001-079-05-003",
  "0-EU-ES-28-07-001-079-07-005",
  "0-EU-ES-28-07-001-079-07-006",
  "0-EU-ES-28-07-001-079-07-001",
  "0-EU-ES-28-07-001-079-07-002",
  "0-EU-ES-28-07-001-079-07-003",
  "0-EU-ES-28-07-001-079-07-004",
  "0-EU-ES-28-07-001-079-15-002",
  "0-EU-ES-28-07-001-079-15-001",
  "0-EU-ES-28-07-001-079-15-004",
  "0-EU-ES-28-07-001-079-15-003",
  "0-EU-ES-28-07-001-079-15-009",
  "0-EU-ES-28-07-001-079-15-007",
  "0-EU-ES-28-07-001-079-15-006",
  "0-EU-ES-28-07-001-079-15-005",
  "0-EU-ES-28-07-001-079-15-008",
  "0-EU-ES-28-07-001-079-08-003",
  "0-EU-ES-28-07-001-079-08-009",
  "0-EU-ES-28-07-001-079-08-004",
  "0-EU-ES-28-07-001-079-08-008",
  "0-EU-ES-28-07-001-079-08-007",
  "0-EU-ES-28-07-001-079-08-002",
  "0-EU-ES-28-07-001-079-08-001",
  "0-EU-ES-28-07-001-079-16-004",
  "0-EU-ES-28-07-001-079-16-008",
  "0-EU-ES-28-07-001-079-16-003",
  "0-EU-ES-28-07-001-079-16-006",
  "0-EU-ES-28-07-001-079-16-001",
  "0-EU-ES-28-07-001-079-16-007",
  "0-EU-ES-28-07-001-079-16-005",
  "0-EU-ES-28-07-001-079-10-002",
  "0-EU-ES-28-07-001-079-10-004",
  "0-EU-ES-28-07-001-079-10-003",
  "0-EU-ES-28-07-001-079-10-005",
  "0-EU-ES-28-07-001-079-10-006",
  "0-EU-ES-28-07-001-079-09-002",
  "0-EU-ES-28-07-001-079-09-007",
  "0-EU-ES-28-07-001-079-09-005",
  "0-EU-ES-28-07-001-079-09-003",
  "0-EU-ES-28-07-001-079-09-006",
  "0-EU-ES-28-07-001-079-09-004",
  "0-EU-ES-28-07-001-079-09-001",
  "0-EU-ES-28-07-001-079-14-005",
  "0-EU-ES-28-07-001-079-14-006",
  "0-EU-ES-28-07-001-079-14-004",
  "0-EU-ES-28-07-001-079-14-003",
  "0-EU-ES-28-07-001-079-14-002",
  "0-EU-ES-28-07-001-079-14-001",
  "0-EU-ES-28-07-001-079-13-002",
  "0-EU-ES-28-07-001-079-13-006",
  "0-EU-ES-28-07-001-079-13-001",
  "0-EU-ES-28-07-001-079-13-003",
  "0-EU-ES-28-07-001-079-13-004",
  "0-EU-ES-28-07-001-079-13-005",
  "0-EU-ES-28-07-001-079-03-004",
  "0-EU-ES-28-07-001-079-03-005",
  "0-EU-ES-28-07-001-079-03-006",
  "0-EU-ES-28-07-001-079-03-001",
  "0-EU-ES-28-07-001-079-03-002",
  "0-EU-ES-28-07-001-079-03-003",
  "0-EU-ES-28-07-001-079-20-001",
  "0-EU-ES-28-07-001-079-20-007",
  "0-EU-ES-28-07-001-079-20-006",
  "0-EU-ES-28-07-001-079-20-004",
  "0-EU-ES-28-07-001-079-20-003",
  "0-EU-ES-28-07-001-079-20-008",
  "0-EU-ES-28-07-001-079-20-005",
  "0-EU-ES-28-07-001-079-20-002"
]



print("Datos obtenidos correctamente:")
print(len(location_ids))
token = load_token()
results = run_queries(token, location_ids)
with open("madrid_100_queries.json", "w", encoding="utf-8") as f:
        json.dump(results, f, ensure_ascii=False, indent=4)